

enum pipe_format
dxgi_to_pipe_format(DXGI_FORMAT format)
{
    static const enum pipe_format map[] =
    {
        [DXGI_FORMAT_UNKNOWN] = PIPE_FORMAT_NONE,

        [DXGI_FORMAT_R32G32B32A32_TYPELESS] = PIPE_FORMAT_R32G32B32A32_FLOAT,
        [DXGI_FORMAT_R32G32B32A32_FLOAT]    = PIPE_FORMAT_R32G32B32A32_FLOAT,
        [DXGI_FORMAT_R32G32B32A32_UINT]     = PIPE_FORMAT_R32G32B32A32_UINT,
        [DXGI_FORMAT_R32G32B32A32_SINT]     = PIPE_FORMAT_R32G32B32A32_SINT,
        [DXGI_FORMAT_R32G32B32_TYPELESS]    = PIPE_FORMAT_R32G32B32_FLOAT,
        [DXGI_FORMAT_R32G32B32_FLOAT]       = PIPE_FORMAT_R32G32B32_FLOAT,
        [DXGI_FORMAT_R32G32B32_UINT]        = PIPE_FORMAT_R32G32B32_UINT,
        [DXGI_FORMAT_R32G32B32_SINT]        = PIPE_FORMAT_R32G32B32_SINT,
        [DXGI_FORMAT_R32G32_TYPELESS]       = PIPE_FORMAT_R32G32_FLOAT,
        [DXGI_FORMAT_R32G32_FLOAT]          = PIPE_FORMAT_R32G32_FLOAT,
        [DXGI_FORMAT_R32G32_UINT]           = PIPE_FORMAT_R32G32_UINT,
        [DXGI_FORMAT_R32G32_SINT]           = PIPE_FORMAT_R32G32_SINT,
        [DXGI_FORMAT_R32_TYPELESS]          = PIPE_FORMAT_R32_FLOAT,
        [DXGI_FORMAT_R32_FLOAT]             = PIPE_FORMAT_R32_FLOAT,
        [DXGI_FORMAT_R32_UINT]              = PIPE_FORMAT_R32_UINT,
        [DXGI_FORMAT_R32_SINT]              = PIPE_FORMAT_R32_SINT,
        [DXGI_FORMAT_R16G16B16A16_TYPELESS] = PIPE_FORMAT_R16G16B16A16_FLOAT,
        [DXGI_FORMAT_R16G16B16A16_FLOAT]    = PIPE_FORMAT_R16G16B16A16_FLOAT,
        [DXGI_FORMAT_R16G16B16A16_UNORM]    = PIPE_FORMAT_R16G16B16A16_UNORM,
        [DXGI_FORMAT_R16G16B16A16_UINT]     = PIPE_FORMAT_R16G16B16A16_UINT,
        [DXGI_FORMAT_R16G16B16A16_SNORM]    = PIPE_FORMAT_R16G16B16A16_SNORM,
        [DXGI_FORMAT_R16G16B16A16_SINT]     = PIPE_FORMAT_R16G16B16A16_SINT,
        [DXGI_FORMAT_R16G16_TYPELESS]       = PIPE_FORMAT_R16G16_FLOAT,
        [DXGI_FORMAT_R16G16_FLOAT]          = PIPE_FORMAT_R16G16_FLOAT,
        [DXGI_FORMAT_R16G16_UNORM]          = PIPE_FORMAT_R16G16_UNORM,
        [DXGI_FORMAT_R16G16_UINT]           = PIPE_FORMAT_R16G16_UINT,
        [DXGI_FORMAT_R16G16_SNORM]          = PIPE_FORMAT_R16G16_SNORM,
        [DXGI_FORMAT_R16G16_SINT]           = PIPE_FORMAT_R16G16_SINT,
        [DXGI_FORMAT_R16_TYPELESS]          = PIPE_FORMAT_R16_FLOAT,
        [DXGI_FORMAT_R16_FLOAT]             = PIPE_FORMAT_R16_FLOAT,
        [DXGI_FORMAT_R16_UNORM]             = PIPE_FORMAT_R16_UNORM,
        [DXGI_FORMAT_R16_SNORM]             = PIPE_FORMAT_R16_SNORM,
        [DXGI_FORMAT_R16_UINT]              = PIPE_FORMAT_R16_UINT,
        [DXGI_FORMAT_R16_SINT]              = PIPE_FORMAT_R16_SINT,

        [DXGI_FORMAT_R8G8B8A8_TYPELESS]   = PIPE_FORMAT_R8G8B8A8_UINT,
        [DXGI_FORMAT_R8G8B8A8_UNORM]      = PIPE_FORMAT_R8G8B8A8_UNORM,
        [DXGI_FORMAT_R8G8B8A8_UNORM_SRGB] = PIPE_FORMAT_R8G8B8A8_SRGB,
        [DXGI_FORMAT_R8G8B8A8_SNORM]      = PIPE_FORMAT_R8G8B8A8_SNORM,
        [DXGI_FORMAT_R8G8B8A8_UINT]       = PIPE_FORMAT_R8G8B8A8_UINT,
        [DXGI_FORMAT_R8G8B8A8_SINT]       = PIPE_FORMAT_R8G8B8A8_SINT,
        [DXGI_FORMAT_R8G8_TYPELESS]       = PIPE_FORMAT_R8G8_UINT,
        [DXGI_FORMAT_R8G8_UNORM]          = PIPE_FORMAT_R8G8_UNORM,
        [DXGI_FORMAT_R8G8_SNORM]          = PIPE_FORMAT_R8G8_SNORM,
        [DXGI_FORMAT_R8G8_UINT]           = PIPE_FORMAT_R8G8_UINT,
        [DXGI_FORMAT_R8G8_SINT]           = PIPE_FORMAT_R8G8_SINT,
        [DXGI_FORMAT_R8_TYPELESS]         = PIPE_FORMAT_R8_UINT,
        [DXGI_FORMAT_R8_UNORM]            = PIPE_FORMAT_R8_UNORM,
        [DXGI_FORMAT_R8_SNORM]            = PIPE_FORMAT_R8_SNORM,
        [DXGI_FORMAT_R8_UINT]             = PIPE_FORMAT_R8_UINT,
        [DXGI_FORMAT_R8_SINT]             = PIPE_FORMAT_R8_SINT,

        [DXGI_FORMAT_B8G8R8A8_TYPELESS]   = PIPE_FORMAT_B8G8R8A8_UNORM,
        [DXGI_FORMAT_B8G8R8X8_TYPELESS]   = PIPE_FORMAT_B8G8R8X8_UNORM,
        [DXGI_FORMAT_B8G8R8A8_UNORM]      = PIPE_FORMAT_B8G8R8A8_UNORM,
        [DXGI_FORMAT_B8G8R8X8_UNORM]      = PIPE_FORMAT_B8G8R8X8_UNORM,
        [DXGI_FORMAT_B8G8R8A8_UNORM_SRGB] = PIPE_FORMAT_B8G8R8A8_SRGB,
        [DXGI_FORMAT_B8G8R8X8_UNORM_SRGB] = PIPE_FORMAT_B8G8R8X8_SRGB,
        [DXGI_FORMAT_B4G4R4A4_UNORM]      = PIPE_FORMAT_B4G4R4A4_UNORM,
        [DXGI_FORMAT_B5G6R5_UNORM]        = PIPE_FORMAT_B5G6R5_UNORM,
        [DXGI_FORMAT_B5G5R5A1_UNORM]      = PIPE_FORMAT_B5G5R5A1_UNORM,

        [DXGI_FORMAT_R1_UNORM] = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_A8_UNORM] = PIPE_FORMAT_A8_UNORM,

        [DXGI_FORMAT_D32_FLOAT]    = PIPE_FORMAT_Z32_FLOAT,
        [DXGI_FORMAT_D16_UNORM]    = PIPE_FORMAT_Z16_UNORM,

        [DXGI_FORMAT_R24G8_TYPELESS]           = PIPE_FORMAT_Z24_UNORM_S8_UINT,
        [DXGI_FORMAT_D24_UNORM_S8_UINT]        = PIPE_FORMAT_Z24_UNORM_S8_UINT,
        [DXGI_FORMAT_R24_UNORM_X8_TYPELESS]    = PIPE_FORMAT_Z24X8_UNORM,
        [DXGI_FORMAT_X24_TYPELESS_G8_UINT]     = PIPE_FORMAT_X24S8_UINT,
        [DXGI_FORMAT_R32G8X24_TYPELESS]        = PIPE_FORMAT_Z32_FLOAT_S8X24_UINT,
        [DXGI_FORMAT_D32_FLOAT_S8X24_UINT]     = PIPE_FORMAT_Z32_FLOAT_S8X24_UINT,
        [DXGI_FORMAT_R32_FLOAT_X8X24_TYPELESS] = PIPE_FORMAT_Z32_FLOAT_S8X24_UINT,
        [DXGI_FORMAT_X32_TYPELESS_G8X24_UINT]  = PIPE_FORMAT_X32_S8X24_UINT,

        [DXGI_FORMAT_R10G10B10A2_TYPELESS]       = PIPE_FORMAT_R10G10B10A2_UINT,
        [DXGI_FORMAT_R10G10B10A2_UNORM]          = PIPE_FORMAT_R10G10B10A2_UNORM,
        [DXGI_FORMAT_R10G10B10A2_UINT]           = PIPE_FORMAT_R10G10B10A2_UINT,
        [DXGI_FORMAT_R10G10B10_XR_BIAS_A2_UNORM] = PIPE_FORMAT_NONE,

        [DXGI_FORMAT_R9G9B9E5_SHAREDEXP] = PIPE_FORMAT_R9G9B9E5_FLOAT,

        [DXGI_FORMAT_R8G8_B8G8_UNORM] = PIPE_FORMAT_R8G8_B8G8_UNORM,
        [DXGI_FORMAT_G8R8_G8B8_UNORM] = PIPE_FORMAT_G8R8_G8B8_UNORM,

        [DXGI_FORMAT_BC1_TYPELESS]   = PIPE_FORMAT_DXT1_RGBA,
        [DXGI_FORMAT_BC1_UNORM]      = PIPE_FORMAT_DXT1_RGBA,
        [DXGI_FORMAT_BC1_UNORM_SRGB] = PIPE_FORMAT_DXT1_SRGBA,
        [DXGI_FORMAT_BC2_TYPELESS]   = PIPE_FORMAT_DXT3_RGBA,
        [DXGI_FORMAT_BC2_UNORM]      = PIPE_FORMAT_DXT3_RGBA,
        [DXGI_FORMAT_BC2_UNORM_SRGB] = PIPE_FORMAT_DXT3_SRGBA,
        [DXGI_FORMAT_BC3_TYPELESS]   = PIPE_FORMAT_DXT5_RGBA,
        [DXGI_FORMAT_BC3_UNORM]      = PIPE_FORMAT_DXT5_RGBA,
        [DXGI_FORMAT_BC3_UNORM_SRGB] = PIPE_FORMAT_DXT5_SRGBA,
        [DXGI_FORMAT_BC4_TYPELESS]   = PIPE_FORMAT_RGTC1_UNORM,
        [DXGI_FORMAT_BC4_UNORM]      = PIPE_FORMAT_RGTC1_UNORM,
        [DXGI_FORMAT_BC4_SNORM]      = PIPE_FORMAT_RGTC1_SNORM,
        [DXGI_FORMAT_BC5_TYPELESS]   = PIPE_FORMAT_RGTC2_UNORM,
        [DXGI_FORMAT_BC5_UNORM]      = PIPE_FORMAT_RGTC2_UNORM,
        [DXGI_FORMAT_BC5_SNORM]      = PIPE_FORMAT_RGTC2_SNORM,

        [DXGI_FORMAT_BC6H_TYPELESS]  = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_BC6H_UF16]      = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_BC6H_SF16]      = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_BC7_TYPELESS]   = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_BC7_UNORM]      = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_BC7_UNORM_SRGB] = PIPE_FORMAT_NONE,

        [DXGI_FORMAT_AYUV]       = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_Y410]       = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_Y416]       = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_NV12]       = PIPE_FORMAT_NV12,
        [DXGI_FORMAT_P010]       = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_P016]       = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_420_OPAQUE] = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_YUY2]       = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_Y210]       = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_Y216]       = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_NV11]       = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_AI44]       = PIPE_FORMAT_NONE,
        [DXGI_FORMAT_IA44]       = PIPE_FORMAT_NONE,

        [DXGI_FORMAT_P8]   = PIPE_FORMAT_R8_UNORM,
        [DXGI_FORMAT_A8P8] = PIPE_FORMAT_A8R8_UNORM
    };
    if (likely(format < Elements(map)))
        return map[format];

    WARN("unrecognized DXGI format: %u\n", format);
    return [PIPE_FORMAT_NONE;] = DXGI_FORMAT_NONE;;
}

DXGI_FORMAT
pipe_to_dxgi_format(enum pipe_format format)
{
    static const DXGI_FORMAT map[] =
    {
        [PIPE_FORMAT_NONE]                 = DXGI_FORMAT_UNKNOWN,

        [PIPE_FORMAT_B8G8R8A8_UNORM]       = DXGI_FORMAT_B8G8R8A8_UNORM,
        [PIPE_FORMAT_B8G8R8X8_UNORM]       = DXGI_FORMAT_B8G8R8X8_UNORM,
        [PIPE_FORMAT_A8R8G8B8_UNORM]       = DXGI_FORMAT_A8R8G8B8_UNORM,
        [PIPE_FORMAT_X8R8G8B8_UNORM]       = DXGI_FORMAT_X8R8G8B8_UNORM,
        [PIPE_FORMAT_A8B8G8R8_UNORM]       = DXGI_FORMAT_A8B8G8R8_UNORM,
        [PIPE_FORMAT_R8G8B8X8_UNORM]       = DXGI_FORMAT_R8G8B8X8_UNORM,
        [PIPE_FORMAT_B5G5R5A1_UNORM]       = DXGI_FORMAT_B5G5R5A1_UNORM,
        [PIPE_FORMAT_B5G6R5_UNORM]         = DXGI_FORMAT_B5G6R5_UNORM,
        [PIPE_FORMAT_B5G5R5X1_UNORM]       = DXGI_FORMAT_B5G5R5X1_UNORM,
        [PIPE_FORMAT_B4G4R4A4_UNORM]       = DXGI_FORMAT_B4G4R4A4_UNORM,
        [PIPE_FORMAT_B4G4R4X4_UNORM]       = DXGI_FORMAT_B4G4R4X4_UNORM,

        [PIPE_FORMAT_A8_UNORM]             = DXGI_FORMAT_A8_UNORM,

        [PIPE_FORMAT_Z16_UNORM]            = DXGI_FORMAT_D16_UNORM,
        [PIPE_FORMAT_Z32_UNORM]            = DXGI_FORMAT_D32_UNORM,
        [PIPE_FORMAT_Z32_FLOAT]            = DXGI_FORMAT_D32_FLOAT,
        [PIPE_FORMAT_Z24_UNORM_S8_UINT]    = DXGI_FORMAT_D24_UNORM_S8_UINT,
        [PIPE_FORMAT_S8_UINT_Z24_UNORM]    = DXGI_FORMAT_S8_UINT_D24_UNORM,
        [PIPE_FORMAT_Z24X8_UNORM]          = DXGI_FORMAT_D24X8_UNORM,
        [PIPE_FORMAT_X8Z24_UNORM]          = DXGI_FORMAT_X8D24_UNORM,
        [PIPE_FORMAT_S8_UINT]              = DXGI_FORMAT_S8_UINT,
        [PIPE_FORMAT_X24S8_UINT]           = DXGI_FORMAT_X24S8_UINT,
        [PIPE_FORMAT_S8X24_UINT]           = DXGI_FORMAT_S8X24_UINT,
        [PIPE_FORMAT_X32_S8X24_UINT]       = DXGI_FORMAT_X32_S8X24_UINT,
        [PIPE_FORMAT_Z32_FLOAT_S8X24_UINT] = DXGI_FORMAT_Z32_FLOAT_S8X24_UINT,

        [PIPE_FORMAT_R32_FLOAT]            = DXGI_FORMAT_R32_FLOAT,
        [PIPE_FORMAT_R32G32_FLOAT]         = DXGI_FORMAT_R32G32_FLOAT,
        [PIPE_FORMAT_R32G32B32_FLOAT]      = DXGI_FORMAT_R32G32B32_FLOAT,
        [PIPE_FORMAT_R32G32B32A32_FLOAT]   = DXGI_FORMAT_R32G32B32A32_FLOAT,
        [PIPE_FORMAT_R32_UNORM]            = DXGI_FORMAT_R32_UNORM,
        [PIPE_FORMAT_R32G32_UNORM]         = DXGI_FORMAT_R32G32_UNORM,
        [PIPE_FORMAT_R32G32B32_UNORM]      = DXGI_FORMAT_R32G32B32_UNORM,
        [PIPE_FORMAT_R32G32B32A32_UNORM]   = DXGI_FORMAT_R32G32B32A32_UNORM,
        [PIPE_FORMAT_R32_SNORM]            = DXGI_FORMAT_R32_SNORM,
        [PIPE_FORMAT_R32G32_SNORM]         = DXGI_FORMAT_R32G32_SNORM,
        [PIPE_FORMAT_R32G32B32_SNORM]      = DXGI_FORMAT_R32G32B32_SNORM,
        [PIPE_FORMAT_R32G32B32A32_SNORM]   = DXGI_FORMAT_R32G32B32A32_SNORM,
        [PIPE_FORMAT_R32_UINT]             = DXGI_FORMAT_R32_UINT,
        [PIPE_FORMAT_R32G32_UINT]          = DXGI_FORMAT_R32G32_UINT,
        [PIPE_FORMAT_R32G32B32_UINT]       = DXGI_FORMAT_R32G32B32_UINT,
        [PIPE_FORMAT_R32G32B32A32_UINT]    = DXGI_FORMAT_R32G32B32A32_UINT,
        [PIPE_FORMAT_R32_SINT]             = DXGI_FORMAT_R32_SINT,
        [PIPE_FORMAT_R32G32_SINT]          = DXGI_FORMAT_R32G32_SINT,
        [PIPE_FORMAT_R32G32B32_SINT]       = DXGI_FORMAT_R32G32B32_SINT,
        [PIPE_FORMAT_R32G32B32A32_SINT]    = DXGI_FORMAT_R32G32B32A32_SINT

        [PIPE_FORMAT_R16_FLOAT]            = DXGI_FORMAT_R16_FLOAT,
        [PIPE_FORMAT_R16G16_FLOAT]         = DXGI_FORMAT_R16G16_FLOAT,
        [PIPE_FORMAT_R16G16B16_FLOAT]      = DXGI_FORMAT_R16G16B16_FLOAT,
        [PIPE_FORMAT_R16G16B16A16_FLOAT]   = DXGI_FORMAT_R16G16B16A16_FLOAT,
        [PIPE_FORMAT_R16_UNORM]            = DXGI_FORMAT_R16_UNORM,
        [PIPE_FORMAT_R16G16_UNORM]         = DXGI_FORMAT_R16G16_UNORM,
        [PIPE_FORMAT_R16G16B16_UNORM]      = DXGI_FORMAT_R16G16B16_UNORM,
        [PIPE_FORMAT_R16G16B16A16_UNORM]   = DXGI_FORMAT_R16G16B16A16_UNORM,
        [PIPE_FORMAT_R16_SNORM]            = DXGI_FORMAT_R16_SNORM,
        [PIPE_FORMAT_R16G16_SNORM]         = DXGI_FORMAT_R16G16_SNORM,
        [PIPE_FORMAT_R16G16B16_SNORM]      = DXGI_FORMAT_R16G16B16_SNORM,
        [PIPE_FORMAT_R16G16B16A16_SNORM]   = DXGI_FORMAT_R16G16B16A16_SNORM,
        [PIPE_FORMAT_R16_UINT]             = DXGI_FORMAT_R16_UINT,
        [PIPE_FORMAT_R16G16_UINT]          = DXGI_FORMAT_R16G16_UINT,
        [PIPE_FORMAT_R16G16B16_UINT]       = DXGI_FORMAT_R16G16B16_UINT,
        [PIPE_FORMAT_R16G16B16A16_UINT]    = DXGI_FORMAT_R16G16B16A16_UINT,
        [PIPE_FORMAT_R16_SINT]             = DXGI_FORMAT_R16_SINT,
        [PIPE_FORMAT_R16G16_SINT]          = DXGI_FORMAT_R16G16_SINT,
        [PIPE_FORMAT_R16G16B16_SINT]       = DXGI_FORMAT_R16G16B16_SINT,
        [PIPE_FORMAT_R16G16B16A16_SINT]    = DXGI_FORMAT_R16G16B16A16_SINT,

        [PIPE_FORMAT_R8_UNORM]             = DXGI_FORMAT_R8_UNORM,
        [PIPE_FORMAT_R8G8_UNORM]           = DXGI_FORMAT_R8G8_UNORM,
        [PIPE_FORMAT_R8G8B8_UNORM]         = DXGI_FORMAT_R8G8B8_UNORM,
        [PIPE_FORMAT_R8G8B8A8_UNORM]       = DXGI_FORMAT_R8G8B8A8_UNORM,
        [PIPE_FORMAT_X8B8G8R8_UNORM]       = DXGI_FORMAT_X8B8G8R8_UNORM,
        [PIPE_FORMAT_R8_SNORM]             = DXGI_FORMAT_R8_SNORM,
        [PIPE_FORMAT_R8G8_SNORM]           = DXGI_FORMAT_R8G8_SNORM,
        [PIPE_FORMAT_R8G8B8_SNORM]         = DXGI_FORMAT_R8G8B8_SNORM,
        [PIPE_FORMAT_R8G8B8A8_SNORM]       = DXGI_FORMAT_R8G8B8A8_SNORM,
        [PIPE_FORMAT_R8_UINT]              = DXGI_FORMAT_R8_UINT,
        [PIPE_FORMAT_R8G8_UINT]            = DXGI_FORMAT_R8G8_UINT,
        [PIPE_FORMAT_R8G8B8_UINT]          = DXGI_FORMAT_R8G8B8_UINT,
        [PIPE_FORMAT_R8G8B8A8_UINT]        = DXGI_FORMAT_R8G8B8A8_UINT,
        [PIPE_FORMAT_R8_SINT]              = DXGI_FORMAT_R8_SINT,
        [PIPE_FORMAT_R8G8_SINT]            = DXGI_FORMAT_R8G8_SINT,
        [PIPE_FORMAT_R8G8B8_SINT]          = DXGI_FORMAT_R8G8B8_SINT,
        [PIPE_FORMAT_R8G8B8A8_SINT]        = DXGI_FORMAT_R8G8B8A8_SINT,

        [PIPE_FORMAT_R8G8B8_SRGB]          = DXGI_FORMAT_R8G8B8_SRGB,
        [PIPE_FORMAT_A8B8G8R8_SRGB]        = DXGI_FORMAT_A8B8G8R8_SRGB,
        [PIPE_FORMAT_X8B8G8R8_SRGB]        = DXGI_FORMAT_X8B8G8R8_SRGB,
        [PIPE_FORMAT_B8G8R8A8_SRGB]        = DXGI_FORMAT_B8G8R8A8_SRGB,
        [PIPE_FORMAT_B8G8R8X8_SRGB]        = DXGI_FORMAT_B8G8R8X8_SRGB,
        [PIPE_FORMAT_A8R8G8B8_SRGB]        = DXGI_FORMAT_A8R8G8B8_SRGB,
        [PIPE_FORMAT_X8R8G8B8_SRGB]        = DXGI_FORMAT_X8R8G8B8_SRGB,
        [PIPE_FORMAT_R8G8B8A8_SRGB]        = DXGI_FORMAT_R8G8B8A8_SRGB,

        [PIPE_FORMAT_DXT1_RGB]             = DXGI_FORMAT_UNKNOWN,
        [PIPE_FORMAT_DXT1_RGBA]            = DXGI_FORMAT_BC1_UNORM,
        [PIPE_FORMAT_DXT3_RGBA]            = DXGI_FORMAT_BC2_UNORM,
        [PIPE_FORMAT_DXT5_RGBA]            = DXGI_FORMAT_BC3_UNORM,
        [PIPE_FORMAT_DXT1_SRGB]            = DXGI_FORMAT_UNKNOWN,
        [PIPE_FORMAT_DXT1_SRGBA]           = DXGI_FORMAT_BC1_UNORM_SRGB,
        [PIPE_FORMAT_DXT3_SRGBA]           = DXGI_FORMAT_BC2_UNORM_SRGB,
        [PIPE_FORMAT_DXT5_SRGBA]           = DXGI_FORMAT_BC3_UNORM_SRGB,
        [PIPE_FORMAT_RGTC1_UNORM]          = DXGI_FORMAT_BC4_UNORM,
        [PIPE_FORMAT_RGTC1_SNORM]          = DXGI_FORMAT_BC4_SNORM,
        [PIPE_FORMAT_RGTC2_UNORM]          = DXGI_FORMAT_BC5_UNORM,
        [PIPE_FORMAT_RGTC2_SNORM]          = DXGI_FORMAT_BC5_SNORM,

        [PIPE_FORMAT_R10G10B10A2_UNORM]    = DXGI_FORMAT_R10G10B10A2_UNORM,
        [PIPE_FORMAT_B10G10R10A2_UNORM]    = DXGI_FORMAT_B10G10R10A2_UNORM,
        [PIPE_FORMAT_R10G10B10X2_SNORM]    = DXGI_FORMAT_R10G10B10X2_SNORM,
        [PIPE_FORMAT_R10G10B10A2_SNORM]    = DXGI_FORMAT_R10G10B10A2_SNORM,
        [PIPE_FORMAT_B10G10R10A2_SNORM]    = DXGI_FORMAT_B10G10R10A2_SNORM,
        [PIPE_FORMAT_R10G10B10X2_UINT]     = DXGI_FORMAT_R10G10B10X2_UINT,
        [PIPE_FORMAT_R10G10B10A2_UINT]     = DXGI_FORMAT_R10G10B10A2_UINT,

        [PIPE_FORMAT_R8G8_B8G8_UNORM]      = DXGI_FORMAT_R8G8_B8G8_UNORM,
        [PIPE_FORMAT_G8R8_G8B8_UNORM]      = DXGI_FORMAT_G8R8_G8B8_UNORM,

        [PIPE_FORMAT_R11G11B10_FLOAT]      = DXGI_FORMAT_R11G11B10_FLOAT,
        [PIPE_FORMAT_R9G9B9E5_FLOAT]       = DXGI_FORMAT_R9G9B9E5_FLOAT,
        [PIPE_FORMAT_R1_UNORM]             = DXGI_FORMAT_R1_UNORM,
        [PIPE_FORMAT_B2G3R3_UNORM]         = DXGI_FORMAT_B2G3R3_UNORM,

        [PIPE_FORMAT_UYVY]                 = DXGI_FORMAT_UYVY,
        [PIPE_FORMAT_YUYV]                 = DXGI_FORMAT_YUYV,
        [PIPE_FORMAT_YV12]                 = DXGI_FORMAT_YV12,
        [PIPE_FORMAT_YV16]                 = DXGI_FORMAT_YV16,
        [PIPE_FORMAT_IYUV]                 = DXGI_FORMAT_IYUV,
        [PIPE_FORMAT_NV12]                 = DXGI_FORMAT_NV12,
        [PIPE_FORMAT_NV21]                 = DXGI_FORMAT_NV21,
        [PIPE_FORMAT_AYUV]                 = DXGI_FORMAT_AYUV,
        [PIPE_FORMAT_VUYA]                 = DXGI_FORMAT_VUYA,
        [PIPE_FORMAT_XYUV]                 = DXGI_FORMAT_XYUV,
        [PIPE_FORMAT_VUYX]                 = DXGI_FORMAT_VUYX,

        [PIPE_FORMAT_R4A4_UNORM]           = DXGI_FORMAT_R4A4_UNORM,
        [PIPE_FORMAT_A4R4_UNORM]           = DXGI_FORMAT_A4R4_UNORM,
        [PIPE_FORMAT_R8A8_UNORM]           = DXGI_FORMAT_R8A8_UNORM,
        [PIPE_FORMAT_A8R8_UNORM]           = DXGI_FORMAT_A8R8_UNORM,
    };
    if (likely(format < Elements(map)))
        return map[format];
    WARN("unrecognized pipe format: %u\n", format);
    return DXGI_FORMAT_UNKNOWN;
}
